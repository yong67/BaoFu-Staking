# BaoFu æ™ºèƒ½åˆçº¦é¡¹ç›®

## é¡¹ç›®æ¦‚è¿°

BaoFuæ˜¯ä¸€ä¸ªåŸºäºBNB Chainæµ‹è¯•ç½‘çš„æ™ºèƒ½åˆçº¦é¡¹ç›®ï¼Œå®ç°äº†ä»£å¸é¢„çº¦ã€é”ä»“å’Œæ”¶ç›Šåˆ†é…æœºåˆ¶ã€‚é¡¹ç›®ä½¿ç”¨Hardhatå¼€å‘æ¡†æ¶ï¼Œå¹¶åœ¨BSCæµ‹è¯•ç½‘ä¸Šéƒ¨ç½²ã€‚

## åˆçº¦æ¶æ„

é¡¹ç›®åŒ…å«ä»¥ä¸‹ä¸»è¦åˆçº¦(åœ°å€å·²éªŒè¯)ï¼š

1. **MockToken** - æ¨¡æ‹Ÿä»£å¸åˆçº¦
   - mBNB: `0xf8E64A6Ae0c3cF9bFD46DB1c91aB819ee7a15765`
   - mUSDT: `0x5bB5fA3bb0cC07cF275a91A4c3db9332DcEE6Fb5`

2. **MockBAOFU** - BAOFUä»£å¸åˆçº¦
   - åœ°å€: `0xA94ac1b1609f16A83373d40F9cDb5ACfB4d39b01`
   - ç‰¹ç‚¹: åŒ…å«ç™½åå•æœºåˆ¶

3. **MockREF** - æ¨èç³»ç»Ÿä»£å¸åˆçº¦
   - åœ°å€: `0xd8222d4623eE0591Df204cD8894d639C6c72f9b0`
   - åŠŸèƒ½: ç®¡ç†æ¨èå…³ç³»å’Œå¥–åŠ±

4. **Reservation** - æ ¸å¿ƒé¢„çº¦åˆçº¦
   - åœ°å€: `0xCc9D192b0258a8b4995fA27d8995ca7dE2b7e73F`
   - ä¸»è¦åŠŸèƒ½:
     - ç”¨æˆ·é¢„çº¦æœºåˆ¶
     - 24å°æ—¶é”ä»“
     - æ”¶ç›Šè®¡ç®—å’Œåˆ†é…
     - æ¨èå¥–åŠ±ç³»ç»Ÿ

## æµåŠ¨æ€§æ± 

é¡¹ç›®åœ¨PancakeSwapä¸Šåˆ›å»ºäº†ä¸¤ä¸ªä¸»è¦æµåŠ¨æ€§æ± ï¼š

1. **mBNB/mUSDT Pair**
   - åœ°å€: `0x94dd43b732Bf4908F5256de91508b17F953bb8E3`
   - å‚¨å¤‡é‡:
     - mUSDT: 10,000,000
     - mBNB: 15,974.44

2. **mBAOFU/mUSDT Pair**
   - åœ°å€: `0x714E66A0E29218E5D587dFF57ae40C710945bBf3`

## éƒ¨ç½²ä¿¡æ¯

- **ç½‘ç»œ**: BSC Testnet
- **PancakeSwap Router**: `0xD99D1c33F9fC3444f8101754aBC46c52416550D1`
- **PancakeSwap Factory**: `0x6725F303b657a9451d8BA641348b6761A6CC7a17`

## ä¸»è¦åŠŸèƒ½

1. **é¢„çº¦æœºåˆ¶**
   - ç”¨æˆ·ä½¿ç”¨mBNBè¿›è¡Œé¢„çº¦
   - é¢„çº¦é‡‘é¢é™åˆ¶: 100-300 USDTç­‰å€¼
   - è‡ªåŠ¨å…‘æ¢ä¸ºBAOFUä»£å¸

2. **é”ä»“æœºåˆ¶**
   - å¼ºåˆ¶24å°æ—¶é”ä»“æœŸ
   - ä½¿ç”¨é˜Ÿåˆ—ç³»ç»Ÿç®¡ç†é”ä»“é¡ºåº

3. **æ”¶ç›Šè®¡ç®—**
   - 24å°æ—¶å†…è¾¾åˆ°100%æ”¶ç›Šç‡æ—¶å¼ºåˆ¶å¹³ä»“
   - è¶…è¿‡24å°æ—¶æŒ‰å®æ—¶BAOFUå¸ä»·è®¡ç®—
   - å¤šä½™åˆ©æ¶¦é€šè¿‡é”€æ¯æœºåˆ¶å¤„ç†

4. **æ¨èå¥–åŠ±ç³»ç»Ÿ**
   - æœ€å¤š8ä»£æ¨èå¥–åŠ±
   - å¥–åŠ±æ¯”ä¾‹:
     - ç¬¬ä¸€ä»£(3äºº): 1.5%
     - ç¬¬äºŒä»£(6äºº): 1.0%
     - ç¬¬ä¸‰ä»£(9äºº): 1.0%
     - ç¬¬å››ä»£(12äºº): 0.5%
     - ç¬¬äº”ä»£(15äºº): 0.5%
     - ç¬¬å…­åˆ°å…«ä»£(20äºº): 0.3%


## å½“å‰é™åˆ¶å’Œéœ€è¦æ”¹è¿›çš„åœ°æ–¹

### âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

#### 1. ç”¨æˆ·æ“ä½œå‰ç½®è¦æ±‚
- **ä»£å¸æˆæƒå¿…éœ€**: ç”¨æˆ·åœ¨è°ƒç”¨ `createReservation()` å‰å¿…é¡»å…ˆè°ƒç”¨ `mBNB.approve(reservationContract, amount)` æˆæƒåˆçº¦ä½¿ç”¨å…¶mBNBä»£å¸
- **æ¨èäººæˆæƒ**: å»ºç«‹æ¨èå…³ç³»æ—¶ï¼Œç†è®ºä¸Šåº”è¯¥ç”±æ¨èäººç»™ä¸‹çº§æ‰“æ¨èå¸å¹¶æä¾›ç­¾åæˆæƒï¼Œä½†å½“å‰å®ç°ä¸­ä¸ºæ–¹ä¾¿æµ‹è¯•ï¼Œç›´æ¥ç”±åˆçº¦ç»™ä¸‹çº§ç”¨æˆ·æ‰“æ¨èå¸

#### 2. Chainlink Automation æœªé…ç½®
- **è‡ªåŠ¨åŒ–åŠŸèƒ½æœªæ¿€æ´»**: è™½ç„¶åˆçº¦å·²å®ç° `checkUpkeep` å’Œ `performUpkeep` å‡½æ•°ï¼Œä½†å°šæœªåœ¨ Chainlink Automation å®˜ç½‘æ³¨å†Œå’Œé…ç½®
- **æ‰‹åŠ¨å¹³ä»“**: ç›®å‰24å°æ—¶é”ä»“åˆ°æœŸæˆ–è¾¾åˆ°100%æ”¶ç›Šæ—¶éœ€è¦æ‰‹åŠ¨å…³é—­é¢„çº¦ï¼Œæ— æ³•è‡ªåŠ¨æ‰§è¡Œ

#### 3. å®‰å…¨æ€§å’Œæµ‹è¯•çŠ¶æ€
- **âš ï¸ æœªç»å…¨é¢æµ‹è¯•**: åˆçº¦å°šæœªè¿›è¡Œå……åˆ†çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **âš ï¸ æœªç»å®‰å…¨å®¡è®¡**: åˆçº¦ä»£ç æœªç»è¿‡ä¸“ä¸šå®‰å…¨å®¡è®¡ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´
- **âš ï¸ Gas ä¼˜åŒ–ä¸è¶³**: åˆçº¦ä»£ç æœªé’ˆå¯¹Gasæ¶ˆè€—è¿›è¡Œä¼˜åŒ–ï¼Œå¯èƒ½å¯¼è‡´äº¤æ˜“æˆæœ¬è¾ƒé«˜

### ğŸ”§ æŠ€æœ¯å€ºåŠ¡å’Œæ”¹è¿›å»ºè®®

#### 1. æ¨èç³»ç»Ÿæ”¹è¿›
```solidity
// å½“å‰å®ç° (åœ¨ createReservation å‡½æ•°ä¸­)
// åŸåˆ™ä¸Šæ˜¯æ¨èäººç»™ä¸‹çº§æ‰“æ¨èå¸(è¿˜è¦åŠ å…¥åˆå§‹æ¨èäººçš„mREFæ¥æº)ï¼Œè¿™è¦æ±‚æ¨èäººçš„ç­¾åæˆ–approve
// åœ¨å®é™…æƒ…å†µä¸­ï¼Œæ¨èæœºåˆ¶åº”å¼•å…¥æ¨èäººå¯¹æ‰“æ¨èå¸çš„ç­¾å
// è¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œç›´æ¥è®©åˆçº¦ç»™ä¸‹çº§æ‰“æ¨èå¸
require(mREF.transfer(msg.sender, REF_TOKEN_AMOUNT), "REF transfer failed");
```

**å»ºè®®æ”¹è¿›**:
- å®ç°åŸºäºç­¾åçš„æ¨èæœºåˆ¶
- æ¨èäººéœ€è¦æä¾›ç­¾åæˆæƒç»™ä¸‹çº§ç”¨æˆ·
- ä½¿ç”¨ EIP-712 æ ‡å‡†çš„ç±»å‹åŒ–ç­¾å

#### 2. ç™½åå•æœºåˆ¶ä¼˜åŒ–
```solidity
// å½“å‰å®ç° (åœ¨ MockBAOFU.sol ä¸­)
//ç™½åå•ã€‚è‹¥åç»­ä¸šåŠ¡ç™½åå•è¾ƒé•¿ï¼Œå¯ä»¥è€ƒè™‘ç”¨MerkleRootæ¥å­˜å‚¨ç™½åå•,merkleproofåŠ ç­¾åéªŒè¯ï¼Œå‡å°gasæ¶ˆè€—
mapping(address => bool) public whitelist;
```

**å»ºè®®æ”¹è¿›**:
- å¯¹äºå¤§é‡åœ°å€çš„ç™½åå•ï¼Œä½¿ç”¨ Merkle Tree å­˜å‚¨
- ç»“åˆ Merkle Proof å’Œç­¾åéªŒè¯
- æ˜¾è‘—é™ä½ Gas æ¶ˆè€—

#### 3. Permit æ”¯æŒ
```solidity
/* æ”¯æŒ permit çš„ä¸€æ­¥å¼é¢„çº¦å‡½æ•°ï¼Œå½“ç„¶åŸç”ŸBNBä¸æ”¯æŒpermmit
function createReservationWithPermit(...) external nonReentrant {
    // å®ç°è¢«æ³¨é‡Šæ‰äº†
}
*/
```

**å»ºè®®æ”¹è¿›**:
- å®Œå–„ `createReservationWithPermit` å‡½æ•°å®ç°
- æ”¯æŒä¸€æ­¥å¼æˆæƒå’Œé¢„çº¦æ“ä½œ
- æå‡ç”¨æˆ·ä½“éªŒ

#### 4. è‡ªåŠ¨åŒ–é…ç½®
å½“å‰éƒ¨ç½²è„šæœ¬ä¸­ Chainlink Automation æ³¨å†Œéƒ¨åˆ†è¢«æ³¨é‡Š:
```javascript
//   // Register with Chainlink Automation
//   console.log("Registering with Chainlink Automation...");
//   // ... æ³¨å†Œä»£ç è¢«æ³¨é‡Š
```

**éœ€è¦å®Œæˆ**:
- åœ¨ [Chainlink Automation](https://automation.chain.link/) å®˜ç½‘æ³¨å†Œ Upkeep
- é…ç½®è§¦å‘æ¡ä»¶å’Œ Gas é™åˆ¶
- å¯ç”¨è‡ªåŠ¨å¹³ä»“åŠŸèƒ½

### ğŸ“‹ å¾…åŠæ¸…å•

#### é«˜ä¼˜å…ˆçº§
- [ ] **å®‰å…¨å®¡è®¡**: è¿›è¡Œä¸“ä¸šçš„æ™ºèƒ½åˆçº¦å®‰å…¨å®¡è®¡
- [ ] **å…¨é¢æµ‹è¯•**: ç¼–å†™å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- [ ] **Gas ä¼˜åŒ–**: ä¼˜åŒ–åˆçº¦ä»£ç ä»¥é™ä½ Gas æ¶ˆè€—
- [ ] **Chainlink é…ç½®**: å®Œæˆ Chainlink Automation çš„æ³¨å†Œå’Œé…ç½®

#### ä¸­ä¼˜å…ˆçº§
- [ ] **æ¨èç­¾åæœºåˆ¶**: å®ç°åŸºäºç­¾åçš„æ¨èç³»ç»Ÿ
- [ ] **Merkle ç™½åå•**: ä¼˜åŒ–ç™½åå•å­˜å‚¨æœºåˆ¶
- [ ] **Permit æ”¯æŒ**: å®Œå–„ä¸€æ­¥å¼æˆæƒåŠŸèƒ½
- [ ] **é”™è¯¯å¤„ç†**: æ”¹å–„é”™è¯¯ä¿¡æ¯å’Œå¼‚å¸¸å¤„ç†

#### ä½ä¼˜å…ˆçº§
- [ ] **å‰ç«¯é›†æˆ**: å¼€å‘ç”¨æˆ·å‹å¥½çš„å‰ç«¯ç•Œé¢
- [ ] **äº‹ä»¶ç›‘æ§**: æ·»åŠ æ›´è¯¦ç»†çš„äº‹ä»¶æ—¥å¿—
- [ ] **æ–‡æ¡£å®Œå–„**: è¡¥å…… API æ–‡æ¡£å’Œç”¨æˆ·æŒ‡å—

### ğŸš¨ é£é™©æç¤º

1. **æ™ºèƒ½åˆçº¦é£é™©**: åˆçº¦å¯èƒ½å­˜åœ¨æ¼æ´ï¼Œè¯·è°¨æ…ä½¿ç”¨
2. **æµåŠ¨æ€§é£é™©**: PancakeSwap æµåŠ¨æ€§ä¸è¶³å¯èƒ½å½±å“äº¤æ˜“
3. **ä»·æ ¼æ³¢åŠ¨é£é™©**: ä»£å¸ä»·æ ¼å‰§çƒˆæ³¢åŠ¨å¯èƒ½å¯¼è‡´æŸå¤±
4. **æµ‹è¯•ç¯å¢ƒ**: å½“å‰éƒ¨ç½²åœ¨æµ‹è¯•ç½‘ï¼Œä»…ä¾›å¼€å‘æµ‹è¯•ä½¿ç”¨


## å¼€å‘ç¯å¢ƒè®¾ç½®

1. å®‰è£…ä¾èµ–:
```bash
npm install
```

2. é…ç½®ç¯å¢ƒå˜é‡:
åˆ›å»º `.env` æ–‡ä»¶å¹¶è®¾ç½®:
```
RPC_URL=https://data-seed-prebsc-1-s1.binance.org:8545/
PRIVATE_KEY=ä½ çš„ç§é’¥
BSC_SCAN_API_KEY=ä½ çš„bscAPI

```

3. ç¼–è¯‘åˆçº¦:
```bash
npx hardhat compile
```

4. éƒ¨ç½²åˆçº¦:
```bash
npx hardhat run scripts/deploy.js --network testnet
```

## æµ‹è¯•

è¿è¡Œæµ‹è¯•:
```bash
npx hardhat test
```

## å·¥å…·è„šæœ¬

1. è·å–æµåŠ¨æ€§æ± ä¿¡æ¯:
```bash
npx hardhat run scripts/getPairAddresses.js --network testnet
```

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿æµ‹è¯•ç½‘è´¦æˆ·æœ‰è¶³å¤Ÿçš„BNBæ”¯ä»˜gasè´¹
2. éƒ¨ç½²å‰æ£€æŸ¥æ‰€æœ‰åˆçº¦åœ°å€é…ç½®
3. æ³¨æ„ä»£å¸æˆæƒå’ŒæµåŠ¨æ€§æ± è®¾ç½®


## è®¸å¯è¯

MIT License
